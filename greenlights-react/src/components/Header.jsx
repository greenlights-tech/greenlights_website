import { useEffect, useRef } from "react";
import { useIntro } from "../context/IntroContext";
import { useLocation } from "react-router-dom";
import { gsap } from "gsap";
export const Header = () => {
  const { introFinished } = useIntro();
  const location = useLocation();
  const isHome = location.pathname === "/";
  const headerRef = useRef(null);
  const reactLogoRef = useRef(null);

  useEffect(() => {
    if (!isHome) {
      // Ruim de Flip-logo op
      const container = document.querySelector(".new-container");
      if (container) {
        const logos = container.querySelectorAll(".child1");
        logos.forEach((logo) => {
          if (logo !== reactLogoRef.current) logo.remove();
        });
      }

      // Laat de HELE header van boven naar beneden infaden
      if (headerRef.current) {
        gsap.fromTo(
          headerRef.current,
          { y: -20, opacity: 0 },
          {
            y: 0,
            opacity: 1,
            duration: 1,
            ease: "power3.out",
          }
        );
      }
    }
  }, [location.pathname, isHome]);

  // De header is onzichtbaar op Home zolang de intro niet klaar is.
  // Op alle andere pagina's (!isHome) is hij altijd zichtbaar.
  const showHeader = !isHome || introFinished;
  return (
    <>
      <header
        ref={headerRef}
        className={`header ${showHeader ? "show" : ""}`}
        style={{ opacity: isHome ? 1 : 0 }}
      >
        <div className="container">
          <div className="bg"></div>
          <div className="new-container-wrapper">
            <div className="new-container" data-flip-id="image">
              {(!isHome || (isHome && introFinished)) && (
                <svg
                  ref={reactLogoRef}
                  className="child1"
                  data-flip-id="image"
                  width="379"
                  height="36"
                  viewBox="0 0 379 36"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    id="letterG"
                    d="M30.816 34.752H28.272C27.856 34.752 27.648 34.56 27.648 34.176L27.696 30.864C24.88 33.68 21.12 35.088 16.416 35.088C11.744 35.088 7.84005 33.456 4.70405 30.192C1.56805 26.928 4.49419e-05 22.64 4.49419e-05 17.328C4.49419e-05 13.776 0.784045 10.656 2.35205 7.96795C3.95204 5.27995 5.96804 3.27995 8.40005 1.96795C10.864 0.655951 13.52 -4.86374e-05 16.368 -4.86374e-05C21.264 -4.86374e-05 24.784 1.51995 26.928 4.55995L26.88 0.863952C26.816 0.479951 27.008 0.287951 27.456 0.287951H30.144C30.56 0.287951 30.768 0.479951 30.768 0.863952V10.752C30.768 11.136 30.56 11.328 30.144 11.328H27.12C26.736 11.328 26.544 11.136 26.544 10.752V10.176C26.544 8.76795 25.568 7.37595 23.616 5.99995C21.696 4.62395 19.232 3.93595 16.224 3.93595C13.216 3.93595 10.496 5.18395 8.06405 7.67995C5.66405 10.144 4.46405 13.456 4.46405 17.616C4.46405 21.744 5.68005 25.024 8.11205 27.456C10.544 29.856 13.264 31.056 16.272 31.056C19.28 31.056 21.648 30.576 23.376 29.616C25.136 28.656 26.448 27.52 27.312 26.208V22.464H18.384C18 22.464 17.808 22.256 17.808 21.84V19.632C17.808 19.248 18 19.056 18.384 19.056H30.816C31.2 19.056 31.392 19.248 31.392 19.632V34.176C31.392 34.56 31.2 34.752 30.816 34.752Z"
                    fill="url(#paint0_linear_2065_28)"
                  />

                  <path
                    id="letterR"
                    d="M67.7235 34.752H63.5475C62.3955 34.752 61.4355 33.984 60.6675 32.448L56.1555 23.28C55.7715 22.48 55.3555 21.888 54.9075 21.504C54.4915 21.12 53.8995 20.912 53.1315 20.88H47.0355V31.152H51.3555C51.7395 31.152 51.9315 31.344 51.9315 31.728V34.176C51.9315 34.56 51.7395 34.752 51.3555 34.752H39.2115C38.7955 34.752 38.5875 34.56 38.5875 34.176V31.728C38.5875 31.344 38.7955 31.152 39.2115 31.152H42.8595V3.88795H39.2115C38.7955 3.88795 38.5875 3.69595 38.5875 3.31195V0.863952C38.5875 0.479951 38.7955 0.287951 39.2115 0.287951H53.9955C57.4195 0.287951 60.2035 1.19995 62.3475 3.02395C64.4915 4.81595 65.5635 7.35995 65.5635 10.656C65.5635 15.68 63.2115 18.816 58.5075 20.064C59.1155 20.544 59.8675 21.616 60.7635 23.28L64.7955 31.152H67.7235C68.1075 31.152 68.2995 31.344 68.2995 31.728V34.176C68.2995 34.56 68.1075 34.752 67.7235 34.752ZM47.0355 17.472H53.1795C58.6195 17.472 61.3395 15.248 61.3395 10.8C61.3395 6.19195 58.6195 3.88795 53.1795 3.88795H47.0355V17.472Z"
                    fill="url(#paint0_linear_2065_28)"
                  />

                  <path
                    id="letterE1"
                    d="M100.662 34.752H75.174C74.758 34.752 74.55 34.56 74.55 34.176V31.728C74.55 31.344 74.758 31.152 75.174 31.152H78.822V3.88795H75.174C74.758 3.88795 74.55 3.69595 74.55 3.31195V0.863952C74.55 0.479951 74.758 0.287951 75.174 0.287951H100.662C101.078 0.287951 101.286 0.479951 101.286 0.863952V8.59195C101.286 9.00795 101.078 9.21595 100.662 9.21595H98.0701C97.686 9.21595 97.494 9.00795 97.494 8.59195V3.88795H82.998V15.792H95.142C95.558 15.792 95.766 15.984 95.766 16.368V18.816C95.766 19.2 95.558 19.392 95.142 19.392H82.998V31.152H97.446V26.448C97.446 26.064 97.654 25.872 98.0701 25.872H100.662C101.078 25.872 101.286 26.064 101.286 26.448V34.176C101.286 34.56 101.078 34.752 100.662 34.752Z"
                    fill="url(#paint0_linear_2065_28)"
                  />

                  <path
                    id="letterE2"
                    d="M134.421 34.752H108.933C108.517 34.752 108.309 34.56 108.309 34.176V31.728C108.309 31.344 108.517 31.152 108.933 31.152H112.581V3.88795H108.933C108.517 3.88795 108.309 3.69595 108.309 3.31195V0.863952C108.309 0.479951 108.517 0.287951 108.933 0.287951H134.421C134.837 0.287951 135.045 0.479951 135.045 0.863952V8.59195C135.045 9.00795 134.837 9.21595 134.421 9.21595H131.829C131.445 9.21595 131.253 9.00795 131.253 8.59195V3.88795H116.757V15.792H128.901C129.317 15.792 129.525 15.984 129.525 16.368V18.816C129.525 19.2 129.317 19.392 128.901 19.392H116.757V31.152H131.205V26.448C131.205 26.064 131.413 25.872 131.829 25.872H134.421C134.837 25.872 135.045 26.064 135.045 26.448V34.176C135.045 34.56 134.837 34.752 134.421 34.752Z"
                    fill="url(#paint0_linear_2065_28)"
                  />

                  <path
                    id="letterN"
                    d="M171.925 34.752H169.333C168.725 34.752 168.245 34.64 167.893 34.416C167.541 34.16 167.205 33.776 166.885 33.264L153.013 11.568L150.613 7.53595H150.517V31.152H154.213C154.629 31.152 154.837 31.344 154.837 31.728V34.176C154.837 34.56 154.629 34.752 154.213 34.752H142.693C142.277 34.752 142.069 34.56 142.069 34.176V31.728C142.069 31.344 142.277 31.152 142.693 31.152H146.341V3.88795H142.693C142.277 3.88795 142.069 3.69595 142.069 3.31195V0.863952C142.069 0.479951 142.277 0.287951 142.693 0.287951H149.413C150.341 0.287951 151.157 0.831951 151.861 1.91995L165.541 23.328L168.277 27.984H168.373V3.88795H164.677C164.293 3.88795 164.101 3.69595 164.101 3.31195V0.863952C164.101 0.479951 164.293 0.287951 164.677 0.287951H176.245C176.629 0.287951 176.821 0.479951 176.821 0.863952V3.31195C176.821 3.69595 176.629 3.88795 176.245 3.88795H172.549V34.176C172.549 34.56 172.341 34.752 171.925 34.752Z"
                    fill="url(#paint0_linear_2065_28)"
                  />

                  <path
                    id="letterL"
                    d="M210.068 34.752H183.812C183.396 34.752 183.188 34.56 183.188 34.176V31.728C183.188 31.344 183.396 31.152 183.812 31.152H187.46V3.88795H183.812C183.396 3.88795 183.188 3.69595 183.188 3.31195V0.863952C183.188 0.479951 183.396 0.287951 183.812 0.287951H195.284C195.7 0.287951 195.908 0.495951 195.908 0.911951V3.26395C195.908 3.67995 195.7 3.88795 195.284 3.88795H191.636V31.152H206.9V26.448C206.9 26.064 207.108 25.872 207.524 25.872H210.116C210.5 25.872 210.692 26.064 210.692 26.448V34.128C210.692 34.544 210.484 34.752 210.068 34.752Z"
                    fill="url(#paint0_linear_2065_28)"
                  />

                  <path
                    id="letterI"
                    d="M228.013 34.752H216.493C216.077 34.752 215.869 34.56 215.869 34.176V31.728C215.869 31.344 216.077 31.152 216.493 31.152H220.141V3.88795H216.493C216.077 3.88795 215.869 3.69595 215.869 3.31195V0.863952C215.869 0.479951 216.077 0.287951 216.493 0.287951H228.013C228.429 0.287951 228.637 0.479951 228.637 0.863952V3.31195C228.637 3.69595 228.429 3.88795 228.013 3.88795H224.317V31.152H228.013C228.429 31.152 228.637 31.344 228.637 31.728V34.176C228.637 34.56 228.429 34.752 228.013 34.752Z"
                    fill="url(#paint0_linear_2065_28)"
                  />

                  <path
                    id="letterG2"
                    d="M264.882 34.752H262.338C261.922 34.752 261.714 34.56 261.714 34.176L261.762 30.864C258.946 33.68 255.186 35.088 250.482 35.088C245.81 35.088 241.906 33.456 238.77 30.192C235.634 26.928 234.066 22.64 234.066 17.328C234.066 13.776 234.85 10.656 236.418 7.96795C238.018 5.27995 240.034 3.27995 242.466 1.96795C244.93 0.655951 247.586 -4.86374e-05 250.434 -4.86374e-05C255.33 -4.86374e-05 258.85 1.51995 260.994 4.55995L260.946 0.863952C260.882 0.479951 261.074 0.287951 261.522 0.287951H264.21C264.626 0.287951 264.834 0.479951 264.834 0.863952V10.752C264.834 11.136 264.626 11.328 264.21 11.328H261.186C260.802 11.328 260.61 11.136 260.61 10.752V10.176C260.61 8.76795 259.634 7.37595 257.682 5.99995C255.762 4.62395 253.298 3.93595 250.29 3.93595C247.282 3.93595 244.562 5.18395 242.13 7.67995C239.73 10.144 238.53 13.456 238.53 17.616C238.53 21.744 239.746 25.024 242.178 27.456C244.61 29.856 247.33 31.056 250.338 31.056C253.346 31.056 255.714 30.576 257.442 29.616C259.202 28.656 260.514 27.52 261.378 26.208V22.464H252.45C252.066 22.464 251.874 22.256 251.874 21.84V19.632C251.874 19.248 252.066 19.056 252.45 19.056H264.882C265.266 19.056 265.458 19.248 265.458 19.632V34.176C265.458 34.56 265.266 34.752 264.882 34.752Z"
                    fill="url(#paint0_linear_2065_28)"
                  />

                  <path
                    id="letterH"
                    d="M306.829 34.752H295.261C294.877 34.752 294.685 34.56 294.685 34.176V31.728C294.685 31.344 294.877 31.152 295.261 31.152H298.957V19.392H281.101V31.152H284.797C285.213 31.152 285.421 31.344 285.421 31.728V34.176C285.421 34.56 285.213 34.752 284.797 34.752H273.277C272.861 34.752 272.653 34.56 272.653 34.176V31.728C272.653 31.344 272.861 31.152 273.277 31.152H276.925V3.88795H273.277C272.861 3.88795 272.653 3.69595 272.653 3.31195V0.863952C272.653 0.479951 272.861 0.287951 273.277 0.287951H284.797C285.213 0.287951 285.421 0.479951 285.421 0.863952V3.31195C285.421 3.69595 285.213 3.88795 284.797 3.88795H281.101V15.888H298.957V3.88795H295.261C294.877 3.88795 294.685 3.69595 294.685 3.31195V0.863952C294.685 0.479951 294.877 0.287951 295.261 0.287951H306.829C307.213 0.287951 307.405 0.479951 307.405 0.863952V3.31195C307.405 3.69595 307.213 3.88795 306.829 3.88795H303.133V31.152H306.829C307.213 31.152 307.405 31.344 307.405 31.728V34.176C307.405 34.56 307.213 34.752 306.829 34.752Z"
                    fill="url(#paint0_linear_2065_28)"
                  />

                  <path
                    id="letterT"
                    d="M335.068 34.752H323.884C323.468 34.752 323.26 34.544 323.26 34.128V31.776C323.26 31.36 323.468 31.152 323.884 31.152H327.532V3.88795H318.46V8.97595C318.46 9.42395 318.236 9.64795 317.788 9.64795H315.1C314.652 9.64795 314.428 9.42395 314.428 8.97595V0.911951C314.428 0.495951 314.652 0.287951 315.1 0.287951H344.044C344.492 0.287951 344.716 0.495951 344.716 0.911951V8.97595C344.716 9.42395 344.492 9.64795 344.044 9.64795H341.308C340.892 9.64795 340.684 9.42395 340.684 8.97595V3.88795H331.708V31.152H335.068C335.516 31.152 335.74 31.36 335.74 31.776V34.128C335.74 34.544 335.516 34.752 335.068 34.752Z"
                    fill="url(#paint0_linear_2065_28)"
                  />

                  <path
                    id="letterS"
                    d="M354.406 34.752H351.718C351.302 34.752 351.094 34.56 351.094 34.176V22.944C351.094 22.528 351.302 22.32 351.718 22.32H354.742C355.126 22.32 355.318 22.528 355.318 22.944V23.952C355.318 24.56 355.686 25.376 356.422 26.4C357.158 27.392 357.894 28.208 358.63 28.848C359.366 29.488 360.342 30.048 361.558 30.528C362.806 30.976 364.15 31.2 365.59 31.2C368.054 31.2 369.974 30.688 371.35 29.664C372.758 28.64 373.462 27.216 373.462 25.392C373.462 24.336 373.062 23.44 372.262 22.704C371.494 21.936 370.486 21.328 369.238 20.88C367.99 20.432 366.598 20.016 365.062 19.632C363.558 19.248 362.038 18.816 360.502 18.336C358.998 17.824 357.622 17.232 356.374 16.56C355.126 15.856 354.102 14.896 353.302 13.68C352.534 12.432 352.15 10.976 352.15 9.31195C352.15 6.62395 353.158 4.39995 355.174 2.63995C357.222 0.879951 359.958 -4.86374e-05 363.382 -4.86374e-05C367.702 -4.86374e-05 370.87 1.26395 372.886 3.79195L372.79 0.815952C372.79 0.431952 372.998 0.239951 373.414 0.239951H376.102C376.486 0.239951 376.678 0.431952 376.678 0.815952V11.28C376.678 11.664 376.486 11.856 376.102 11.856H373.078C372.694 11.856 372.502 11.664 372.502 11.28V9.93595C372.502 8.62395 371.766 7.29595 370.294 5.95195C368.822 4.60795 366.662 3.93595 363.814 3.93595C361.702 3.93595 359.99 4.44795 358.678 5.47195C357.398 6.46395 356.758 7.74395 356.758 9.31195C356.758 10.432 357.158 11.392 357.958 12.192C358.758 12.992 359.798 13.632 361.078 14.112C362.358 14.592 363.766 15.04 365.302 15.456C366.838 15.84 368.374 16.272 369.91 16.752C371.446 17.232 372.854 17.808 374.134 18.48C375.414 19.152 376.454 20.08 377.254 21.264C378.054 22.416 378.454 23.792 378.454 25.392C378.454 28.208 377.446 30.528 375.43 32.352C373.414 34.176 370.406 35.088 366.406 35.088C363.462 35.088 361.03 34.496 359.11 33.312C357.19 32.128 355.798 30.848 354.934 29.472L354.982 34.176C354.982 34.56 354.79 34.752 354.406 34.752Z"
                    fill="url(#paint0_linear_2065_28)"
                  />

                  <defs>
                    <linearGradient
                      id="paint0_linear_2065_28"
                      x1="189.696"
                      y1="-13.248"
                      x2="189.696"
                      y2="47.752"
                      gradientUnits="userSpaceOnUse"
                    >
                      <stop id="color1" stopColor="#20FF85" />
                      <stop id="color2" offset="1" stopColor="#00D661" />
                    </linearGradient>
                  </defs>
                </svg>
              )}
            </div>
            <div className="tagline-wrapper">
              <p className="tagline">Slimme instroom, blijvend resultaat</p>
            </div>
          </div>
        </div>
      </header>
    </>
  );
};
